fields @timestamp, @message
| filter @message like /\/a\/b\/c\/.*/
| parse @message /\/a\/b\/c\/(?<variable>[^\s]+)/
| sort @timestamp asc
| stats count() as matchCount by bin(4m)
| filter matchCount > 0
| filter variable == "xyz"
| fields @timestamp, @message
| filter @message like /error/
| sort @timestamp desc
| limit 1
| stats count() as errorCount by bin(4m)
| filter errorCount == 0
| filter not(@message like /\/a\/b\/c\/.*/)
